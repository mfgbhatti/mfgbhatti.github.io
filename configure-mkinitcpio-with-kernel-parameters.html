<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />

  <!-- Enable responsiveness on mobile devices-->
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1"
  />

  <title>
     Configure Mkinitcpio With Kernel Parameters &middot; mfgbhatti 
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css" />
  <link rel="stylesheet" href="/public/css/syntax.css" />
  <link rel="stylesheet" href="/public/css/hyde.css" />
  <link
    rel="stylesheet"
    href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface"
  />

  <!-- Icons -->
  <link
    rel="apple-touch-icon-precomposed"
    sizes="144x144"
    href="public/apple-touch-icon-144-precomposed.png"
  />
  <link rel="shortcut icon" href="public/favicon.ico" />

  <!-- RSS -->
  <link
    rel="alternate"
    type="application/rss+xml"
    title="RSS"
    href="/atom.xml"
  />
</head>


  <body class="theme-base-0e">

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href=""> mfgbhatti </a>
      </h1>
      <p class="lead">Hi! I'm hobbyist code writer. This is not showcase of my work, but a place to keep solutions to some problems and may be some of my ideas.
</p>
    </div>

    <nav class="sidebar-nav">
      <a
        class="sidebar-nav-item"
        href="/"
        >Home</a
      >

              
      <a
        class="sidebar-nav-item"
        href="/about"
        >About</a
      >
            
      <a
        class="sidebar-nav-item"
        href="/excercise"
        >Excercises</a
      >
                  

      <a class="sidebar-nav-item" href="https://github.com/poole/hyde"
        >GitHub project</a
      >
      <span class="sidebar-nav-item">Currently v2.1.0</span>
    </nav>

    <p>&copy; 2025. All rights reserved.</p>
  </div>
</div>


    <div class="content container">
      <div class="post">
  <h1 class="post-title">Configure Mkinitcpio With Kernel Parameters</h1>
  <span class="post-date">17 May 2024</span>
  <p>It uses <code class="language-plaintext highlighter-rouge">default_options="--cmdline /etc/kernel/cmdline"</code>. If you are using a single uefi binary file to load your system without any bootloader. This option will generate binary with kernel parameters. This will be helpfull if you are using btrfs with luks and swap is enabled on a laptop with suspend-then-hibernate from systemd.</p>

<p>My <code class="language-plaintext highlighter-rouge">/etc/kernel/cmdline</code> contains</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root=/dev/mapper/cryptroot
resume=UUID=XxXxxxXX-xxxx-Xxxx-xXXx-xxxXxxXXxXXX
resume_offset=nnnnNNNN rw rootflags=subvol=@ rootfstype=btrfs
</code></pre></div></div>

<p>If you are using luks and want to pass discard parameter to kernel on boot. You should put it in <code class="language-plaintext highlighter-rouge">cryptab</code> or <code class="language-plaintext highlighter-rouge">crypttab.initramfs</code>. Offset can be obtained by running</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># btrfs inspect-internal map-swapfile -r swap_file
</code></pre></div></div>

<p>You can verify parameters from <code class="language-plaintext highlighter-rouge">/proc/cmdline</code> after booting.</p>

</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/arch-linux-working-on-unified-kernel-image.html">
            Arch Linux Working On Unified Kernel Image
            <small>14 May 2025</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/crypttab-and-crypttabinitramfs.html">
            Crypttab And Crypttabinitramfs
            <small>10 May 2024</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/qxl-with-wayland-and-4k-resolution.html">
            QXL With Wayland And 4K Resolution
            <small>29 Mar 2024</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

    </div>

  </body>
</html>
